- doc: Test outline for RNAseq_PE
  job:
    gtf:
      class: File
      location: https://zenodo.org/record/4541751/files/Drosophila_melanogaster.BDGP6.87.gtf
      filetype: gtf
    PE fastq input:
      class: Collection
      collection_type: list:paired
      elements:
      - class: Collection
        type: paired
        identifier: GSM461177
        elements:
        - identifier: forward
          class: File
          path: test-data/GSM461177_chr3R_enriched2_R1.fastq.gz
          filetype: fastqsanger
        - identifier: reverse
          class: File
          path: test-data/GSM461177_chr3R_enriched2_R2.fastq.gz
          filetype: fastqsanger
    forward_adapter: GATCGGAAGAGCACACGTCTGAACTCCAGTCAC
    reverse_adapter: GATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT
    reference_genome: dm6
    strandness: unstranded
  outputs:
    output_log:
      element_tests:
        GSM461177:
          asserts:
            - that: "has_text"
              text: "Number of input reads |\t515166"
            - that: "has_text"
              text: "Uniquely mapped reads number |\t486263"
            - that: "has_text"
              text: "Number of reads mapped to multiple loci |\t14713"
    mapped-reads:
      element_tests:
        GSM461177:
          asserts:
            has_size:
              value: 36651610
              delta: 4000000
    'MultiQC on input dataset(s): Stats':
      element_tests:
        cutadapt:
          asserts:
            has_text:
              text: "GSM461177_2\t4.0\t518297\t11874\t12177\t3131\t515166\t38024881\t801807\t37020367\t2.641728188445876"
        general_stats:
          asserts:
            has_text:
              text: "GSM461177\t94.39\t486263.0"
        sources:
          asserts:
            has_n_lines:
              n: 4
        star:
          asserts:
            has_text:
              text: "GSM461177\t515166.0\t71.0\t486263.0\t94.39\t71.25\t60221.0\t60031.0\t59305.0\t893.0\t11.0\t12.0\t0.57\t0.0\t1.51\t0.0\t1.28\t14713.0\t2.86\t3313.0\t0.64\t0.0\t2.07\t0.04\t0\t10671\t206"
    MultiQC webpage:
      asserts:
        - that: "has_text"
          text: "GSM461177"
        - that: "has_text"
          text: "<a href=\"#cutadapt_filtered_reads\" class=\"nav-l2\">Filtered Reads</a>"
        - that: "has_text"
          text: "<a href=\"#star\" class=\"nav-l1\">STAR</a>"
    reads_per_gene from STAR:
      element_tests:
        GSM461177:
          asserts:
            - that: "has_text"
              text: "N_ambiguous\t13296\t2614\t2430"
            - that: "has_text"
              text: "FBgn0010247\t37\t19\t18"
    HTS count like output:
      element_tests:
        GSM461177:
          asserts:
            has_text:
              text: "FBgn0010247\t37"
    transcripts_expression:
      element_tests:
        GSM461177:
          asserts:
            has_text:
              text: "FBtr0078104\t-\t-\tFBgn0031217\tCG11377\t-\tchr2L:102379-104142\t1583\t0.0465361\t1.26098\t0\t4.82757\tOK"
    genes_expression:
      element_tests:
        GSM461177:
          asserts:
            has_text:
              text: "FBgn0031217\t-\t-\tFBgn0031217\tCG11377\t-\tchr2L:102379-104142\t-\t-\t1.26098\t0\t6.13928\tOK"
    both strands coverage:
      element_tests:
        GSM461177:
            has_size:
              value: 5400536
              delta: 500000
    negative strand coverage:
      element_tests:
        GSM461177:
            has_size:
              value: 3306331
              delta: 300000
    positive strand coverage:
      element_tests:
        GSM461177:
            has_size:
              value: 3284159
              delta: 300000
